Objetivo: Refatorar e aprimorar o sistema de autenticaÃ§Ã£o e controle de acesso do meu app SaaS usando Supabase com React, TypeScript e Context API.

CenÃ¡rio atual:

JÃ¡ tenho um AuthContext funcional com login e logout.

JÃ¡ uso Supabase e tenho a tabela profiles com id, role e full_name.

Quero agora adicionar: controle de roles, manipulaÃ§Ã£o de perfis, proteÃ§Ã£o de rotas e melhorias nas funÃ§Ãµes existentes.

ğŸš§ ModificaÃ§Ãµes e implementaÃ§Ãµes necessÃ¡rias
ğŸ” FunÃ§Ãµes de AutenticaÃ§Ã£o
 login(email, password): Validar credenciais e retornar erro amigÃ¡vel em caso de falha.

 logout(): Encerrar sessÃ£o e limpar estado/contexto.

 register({ email, password, full_name }): Criar conta, inserir no profiles e validar os dados.

 resetPassword(email): Enviar link de recuperaÃ§Ã£o de senha.

 updateProfile(profileData): Atualizar nome e outros campos do usuÃ¡rio logado.

ğŸ›‚ FunÃ§Ãµes de Controle de Acesso
 hasRole(role: string): Verifica se o usuÃ¡rio atual possui o role esperado.

 checkPermission(permission: string): FunÃ§Ã£o extra para permissÃµes mais especÃ­ficas no futuro.

 updateRole(userId: string, role: string): Permitir que administradores mudem o role de outro usuÃ¡rio.

ğŸ‘¤ FunÃ§Ãµes de GestÃ£o de Perfil
 createProfile(id: UUID, full_name: string, role: string): Executada apÃ³s registro.

 updateProfile(profileData): Atualiza campos do perfil.

 deleteProfile(userId): (Admin) Remove perfil de usuÃ¡rio.

ğŸ” FunÃ§Ãµes de SessÃ£o
 refreshSession(): Revalida ou renova a sessÃ£o do Supabase.

 validateSession(): Verifica se a sessÃ£o ainda Ã© vÃ¡lida (usado em useEffect inicial).

 clearSession(): Garantir limpeza total de estado apÃ³s logout.

âŒ FunÃ§Ãµes de Tratamento de Erros
 handleAuthError(error: SupabaseError): Exibir erros amigÃ¡veis de login/registro.

 handleValidationError(errors: ValidationError[]): Feedback visual na interface.

ğŸš€ FunÃ§Ãµes de NavegaÃ§Ã£o
 redirectAfterLogin(): ApÃ³s login, redirecionar baseado na role (admin vai para /admin, cliente para /dashboard).

 redirectAfterLogout(): Levar o usuÃ¡rio para a pÃ¡gina de login ou pÃºblica.

ğŸ§© DependÃªncias e ConsideraÃ§Ãµes
Todas essas funÃ§Ãµes devem respeitar o contexto de multitenancy e role-based access.

A sessÃ£o do Supabase jÃ¡ Ã© persistente, mas pode ser revalidada com supabase.auth.getSession().

A profiles estÃ¡ conectada ao auth.users (foreign key) e jÃ¡ tem RLS ativada.

ğŸ§  Sua tarefa: Com base nesses requisitos, atualize meu AuthContext.tsx, e implemente os arquivos e funÃ§Ãµes listados acima, de forma limpa, modular e segura.

